<!DOCTYPE html>
<html dir="<%= language === 'ar' ? 'rtl' : 'ltr' %>" lang="<%= language || 'ar' %>">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="app.title" data-i18n-ns="common">حاسبة التداول الذكية - Trading Calculator Pro</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <link rel="stylesheet" href="/css/style.css">
    <script>
        // تعيين اللغة من الخادم
        window.initialLanguage = '<%= language || "ar" %>';
    </script>
    <script src="/js/i18n.js"></script>
</head>
<body>
    <!-- شريط التنقل -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <img src="/images/logo.png" alt="CYLENDRA Calculator" class="logo-img">
            </div>
            <div class="nav-links">
                <a href="#calculator" class="nav-link active">
                    <i class="fas fa-calculator"></i> <span data-i18n="navigation.calculator" data-i18n-ns="common">الحاسبة</span>
                </a>
                <a href="#results" class="nav-link">
                    <i class="fas fa-chart-bar"></i> <span data-i18n="navigation.results" data-i18n-ns="common">النتائج</span>
                </a>
                <a href="#guide" class="nav-link">
                    <i class="fas fa-book"></i> <span data-i18n="navigation.guide" data-i18n-ns="common">دليل الاستخدام</span>
                </a>
                <div class="language-selector">
                    <select id="languageSelector" class="language-select" title="اختر اللغة / Choose Language">
                        <option value="ar">🇸🇦 العربية</option>
                        <option value="en">🇺🇸 English</option>
                        <option value="ru">🇷🇺 Русский</option>
                        <option value="fr">🇫🇷 Français</option>
                        <option value="tr">🇹🇷 Türkçe</option>
                    </select>
                </div>
            </div>
        </div>
    </nav>

    <!-- القسم الرئيسي -->
    <div class="hero-section">
        <div class="container">
            <h1 class="hero-main-title">
                <span data-i18n="app.mainTitle" data-i18n-ns="common">حاسبة التداول الذكية المقدمة من سيليندرا</span>
            </h1>
            <h2 class="hero-title">
                <i class="fas fa-rocket"></i>
                <span data-i18n="app.subtitle" data-i18n-ns="common">احسب أرباحك المستقبلية بدقة احترافية</span>
            </h2>
            <p class="hero-subtitle" data-i18n="app.description" data-i18n-ns="common">
                أداة متقدمة لحساب العوائد مع إعادة الاستثمار والمصاريف الشهرية
            </p>
        </div>
    </div>

    <div class="container main-container">
        <!-- قسم الحاسبة -->
        <div id="calculator" class="section">
            <div class="grid-layout">
                <!-- نموذج الإدخال -->
                <div class="card input-card">
                    <div class="card-header">
                        <h2>
                            <i class="fas fa-sliders-h"></i>
                            <span data-i18n="title" data-i18n-ns="calculator">إعدادات الحساب</span>
                        </h2>
                    </div>
                    <div class="card-body">
                        <form id="calculatorForm">
                            <!-- رأس المال -->
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-dollar-sign icon-label"></i>
                                    <span data-i18n="fields.principal.label" data-i18n-ns="calculator">رأس المال الأساسي</span>
                                    <span class="tooltip-icon" data-i18n-title="fields.principal.tooltip" data-i18n-ns="calculator" title="المبلغ الذي ستبدأ به التداول">
                                        <i class="fas fa-info-circle"></i>
                                    </span>
                                </label>
                                <div class="input-wrapper">
                                    <input 
                                        type="number" 
                                        name="principal" 
                                        id="principal"
                                        class="form-input" 
                                        value="1000"
                                        step="0.01" 
                                        min="1"
                                        required
                                    >
                                    <span class="input-suffix">$</span>
                                </div>
                            </div>

                            <!-- طريقة حساب الربح -->
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-coins icon-label"></i>
                                    <span data-i18n="fields.profitMode.label" data-i18n-ns="calculator">طريقة حساب الربح</span>
                                    <span class="tooltip-icon" data-i18n-title="fields.profitMode.tooltip" data-i18n-ns="calculator" title="اختر طريقة حساب الربح لكل صفقة">
                                        <i class="fas fa-info-circle"></i>
                                    </span>
                                </label>
                                <div class="profit-mode-tabs">
                                    <button type="button" class="profit-mode-btn active" data-mode="fixed">
                                        <i class="fas fa-dollar-sign"></i>
                                        <span data-i18n="fields.profitMode.fixed" data-i18n-ns="calculator">ربح ثابت</span>
                                    </button>
                                    <button type="button" class="profit-mode-btn" data-mode="percentage">
                                        <i class="fas fa-percent"></i>
                                        <span data-i18n="fields.profitMode.percentage" data-i18n-ns="calculator">نسبة مئوية</span>
                                    </button>
                                </div>
                            </div>

                            <!-- الربح الثابت لكل صفقة -->
                            <div class="form-group profit-mode-group" id="fixedProfitGroup">
                                <label class="form-label">
                                    <i class="fas fa-coins icon-label"></i>
                                    <span data-i18n="fields.profitPerTrade.label" data-i18n-ns="calculator">الربح لكل صفقة</span>
                                    <span class="tooltip-icon" data-i18n-title="fields.profitPerTrade.tooltip" data-i18n-ns="calculator" title="الربح المتوقع من كل صفقة تداول بالدولار">
                                        <i class="fas fa-info-circle"></i>
                                    </span>
                                </label>
                                <div class="input-wrapper">
                                    <input
                                        type="number"
                                        name="profitPerTrade"
                                        id="profitPerTrade"
                                        class="form-input"
                                        value="10"
                                        step="0.01"
                                        min="0.01"
                                        required
                                    >
                                    <span class="input-suffix">$</span>
                                </div>
                            </div>

                            <!-- النسبة المئوية من رأس المال -->
                            <div class="form-group profit-mode-group" id="percentageProfitGroup" style="display: none;">
                                <label class="form-label">
                                    <i class="fas fa-percent icon-label"></i>
                                    <span data-i18n="fields.dailyProfitPercentage.label" data-i18n-ns="calculator">نسبة الربح اليومي من رأس المال</span>
                                    <span class="tooltip-icon" data-i18n-title="fields.dailyProfitPercentage.tooltip" data-i18n-ns="calculator" title="النسبة المئوية من رأس المال التي تريد ربحها يومياً">
                                        <i class="fas fa-info-circle"></i>
                                    </span>
                                </label>
                                <div class="input-wrapper">
                                    <input
                                        type="number"
                                        name="dailyProfitPercentage"
                                        id="dailyProfitPercentage"
                                        class="form-input"
                                        value="1"
                                        step="0.01"
                                        min="0.01"
                                        max="100"
                                    >
                                    <span class="input-suffix">%</span>
                                </div>
                                <div class="profit-calculation-info">
                                    <p>
                                        <i class="fas fa-info-circle"></i>
                                        <span data-i18n="fields.dailyProfitPercentage.calculation" data-i18n-ns="calculator">الربح اليومي = رأس المال × النسبة ÷ عدد الصفقات</span>
                                    </p>
                                    <p id="profitCalculationDisplay" class="calculation-result">
                                        <span data-i18n="fields.dailyProfitPercentage.example" data-i18n-ns="calculator">مثال: سيكون الربح لكل صفقة</span> <strong>$2.00</strong>
                                    </p>
                                </div>
                            </div>

                            <!-- عدد الصفقات -->
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-exchange-alt icon-label"></i>
                                    <span data-i18n="fields.tradesPerDay.label" data-i18n-ns="calculator">عدد الصفقات اليومية</span>
                                    <span class="tooltip-icon" data-i18n-title="fields.tradesPerDay.tooltip" data-i18n-ns="calculator" title="عدد الصفقات التي تنفذها في اليوم الواحد">
                                        <i class="fas fa-info-circle"></i>
                                    </span>
                                </label>
                                <input 
                                    type="number" 
                                    name="tradesPerDay"
                                    id="tradesPerDay"
                                    class="form-input" 
                                    value="5"
                                    min="1"
                                    required
                                >
                            </div>

                            <!-- نسبة إعادة الاستثمار -->
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-percent icon-label"></i>
                                    <span data-i18n="fields.reinvestPercent.label" data-i18n-ns="calculator">نسبة إعادة الاستثمار</span>
                                    <span class="tooltip-icon" data-i18n-title="fields.reinvestPercent.tooltip" data-i18n-ns="calculator" title="النسبة المئوية من الأرباح التي ستعيد استثمارها">
                                        <i class="fas fa-info-circle"></i>
                                    </span>
                                </label>
                                <div class="slider-container">
                                    <input 
                                        type="range" 
                                        name="reinvestPercent"
                                        id="reinvestPercent"
                                        class="form-slider" 
                                        value="50"
                                        min="0"
                                        max="100"
                                        step="1"
                                    >
                                    <div class="slider-value">
                                        <span id="reinvestValue">50</span>%
                                    </div>
                                </div>
                            </div>

                            <!-- أيام العمل -->
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-calendar-week icon-label"></i>
                                    <span data-i18n="fields.workDaysPerWeek.label" data-i18n-ns="calculator">أيام العمل في الأسبوع</span>
                                    <span class="tooltip-icon" data-i18n-title="fields.workDaysPerWeek.tooltip" data-i18n-ns="calculator" title="عدد أيام التداول في الأسبوع (5 = من الإثنين للجمعة)">
                                        <i class="fas fa-info-circle"></i>
                                    </span>
                                </label>
                                <select name="workDaysPerWeek" id="workDaysPerWeek" class="form-select">
                                    <option value="5" data-i18n="fields.workDaysPerWeek.options.5" data-i18n-ns="calculator">5 أيام (الإثنين - الجمعة)</option>
                                    <option value="6" data-i18n="fields.workDaysPerWeek.options.6" data-i18n-ns="calculator">6 أيام</option>
                                    <option value="7" data-i18n="fields.workDaysPerWeek.options.7" data-i18n-ns="calculator">7 أيام (طوال الأسبوع)</option>
                                </select>
                            </div>

                            <!-- المصاريف الشهرية -->
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-receipt icon-label"></i>
                                    <span data-i18n="fields.monthlyExpenses.label" data-i18n-ns="calculator">المصاريف الشهرية</span>
                                    <span class="tooltip-icon" data-i18n-title="fields.monthlyExpenses.tooltip" data-i18n-ns="calculator" title="المصاريف التي سيتم خصمها من أرباحك شهرياً">
                                        <i class="fas fa-info-circle"></i>
                                    </span>
                                </label>
                                <div class="input-wrapper">
                                    <input 
                                        type="number" 
                                        name="monthlyExpenses"
                                        id="monthlyExpenses"
                                        class="form-input" 
                                        value="0"
                                        step="0.01"
                                        min="0"
                                    >
                                    <span class="input-suffix">$</span>
                                </div>
                            </div>

                            <!-- عدد الأيام -->
                            <div class="form-group">
                                <label class="form-label">
                                    <i class="fas fa-calendar-alt icon-label"></i>
                                    <span data-i18n="fields.days.label" data-i18n-ns="calculator">المدة الزمنية</span>
                                    <span class="tooltip-icon" data-i18n-title="fields.days.tooltip" data-i18n-ns="calculator" title="عدد الأيام التي تريد حساب الأرباح لها">
                                        <i class="fas fa-info-circle"></i>
                                    </span>
                                </label>
                                <div class="days-options">
                                    <button type="button" class="day-btn" data-days="30" data-i18n="fields.days.quickOptions.30" data-i18n-ns="calculator">شهر</button>
                                    <button type="button" class="day-btn" data-days="90" data-i18n="fields.days.quickOptions.90" data-i18n-ns="calculator">3 أشهر</button>
                                    <button type="button" class="day-btn" data-days="180" data-i18n="fields.days.quickOptions.180" data-i18n-ns="calculator">6 أشهر</button>
                                    <button type="button" class="day-btn" data-days="365" data-i18n="fields.days.quickOptions.365" data-i18n-ns="calculator">سنة</button>
                                    <button type="button" class="day-btn" data-days="730" data-i18n="fields.days.quickOptions.730" data-i18n-ns="calculator">سنتان</button>
                                </div>
                                <input 
                                    type="number" 
                                    name="days"
                                    id="days"
                                    class="form-input" 
                                    value="365"
                                    min="1"
                                    required
                                >
                            </div>

                            <!-- زر الحساب -->
                            <button type="submit" class="btn btn-primary btn-large">
                                <i class="fas fa-calculator"></i>
                                <span data-i18n="buttons.calculate" data-i18n-ns="common">احسب الأرباح الآن</span>
                            </button>
                        </form>
                    </div>
                </div>

                <!-- بطاقات المعلومات السريعة -->
                <div class="info-cards">
                    <div class="info-card">
                        <div class="info-icon">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <h3 data-i18n="tips.smartTip.title" data-i18n-ns="guide">نصيحة ذكية</h3>
                        <p data-i18n="tips.smartTip.description" data-i18n-ns="guide">ابدأ بنسبة إعادة استثمار 50% لتحقيق توازن بين النمو والأرباح النقدية</p>
                    </div>

                    <div class="info-card">
                        <div class="info-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3 data-i18n="tips.riskManagement.title" data-i18n-ns="guide">إدارة المخاطر</h3>
                        <p data-i18n="tips.riskManagement.description" data-i18n-ns="guide">لا تنسَ حساب المصاريف الشهرية للحصول على توقعات واقعية</p>
                    </div>

                    <div class="info-card">
                        <div class="info-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3 data-i18n="tips.compoundGrowth.title" data-i18n-ns="guide">النمو المركب</h3>
                        <p data-i18n="tips.compoundGrowth.description" data-i18n-ns="guide">إعادة الاستثمار تساعد على تحقيق نمو أسي في رأس المال على المدى الطويل</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- قسم النتائج -->
        <div id="results" class="section" style="display: none;">
            <!-- البطاقات الإحصائية -->
            <div class="stats-grid" id="statsGrid"></div>

            <!-- بطاقة نسبة الخطورة -->
            <div class="risk-card-container">
                <div class="card risk-card" id="riskCard">
                    <div class="card-header">
                        <h2>
                            <i class="fas fa-exclamation-triangle"></i>
                            <span data-i18n="risk.title" data-i18n-ns="results">تقييم نسبة الخطورة</span>
                        </h2>
                    </div>
                    <div class="card-body risk-card-body">
                        <div class="risk-content">
                            <div class="risk-gauge">
                                <div class="risk-circle" id="riskCircle">
                                    <div class="risk-value">
                                        <span id="riskRatioValue">0</span>%
                                    </div>
                                </div>
                            </div>
                            <div class="risk-info">
                                <div class="risk-level">
                                    <h3 data-i18n="risk.level" data-i18n-ns="results">مستوى الخطورة:</h3>
                                    <p id="riskLevelText" class="risk-level-text" data-i18n="risk.levels.veryLow" data-i18n-ns="results">منخفضة جداً</p>
                                </div>
                                <div class="risk-description">
                                    <p id="riskDescription" data-i18n="risk.descriptions.veryLow" data-i18n-ns="results"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- الرسوم البيانية -->
            <div class="charts-section">
                <div class="card chart-card">
                    <div class="card-header">
                        <h2>
                            <i class="fas fa-chart-area"></i>
                            <span data-i18n="charts.balanceAndEarnings" data-i18n-ns="results">تطور الرصيد والأرباح</span>
                        </h2>
                    </div>
                    <div class="card-body">
                        <canvas id="mainChart"></canvas>
                    </div>
                </div>

                <div class="grid-2">
                    <div class="card chart-card">
                        <div class="card-header">
                            <h3 data-i18n="charts.earningsDistribution" data-i18n-ns="results">توزيع الأرباح</h3>
                        </div>
                        <div class="card-body">
                            <canvas id="pieChart"></canvas>
                        </div>
                    </div>

                    <div class="card chart-card">
                        <div class="card-header">
                            <h3 data-i18n="charts.monthlyROI" data-i18n-ns="results">نسبة العائد الشهري</h3>
                        </div>
                        <div class="card-body">
                            <canvas id="roiChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- جدول البيانات الشهرية -->
            <div class="card table-card">
                <div class="card-header">
                    <h2>
                        <i class="fas fa-table"></i>
                        <span data-i18n="tables.monthlyDetails" data-i18n-ns="results">التفاصيل الشهرية</span>
                    </h2>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="data-table" id="dataTable">
                            <thead>
                                <tr>
                                    <th data-i18n="tables.headers.month" data-i18n-ns="results">الشهر</th>
                                    <th data-i18n="tables.headers.earnings" data-i18n-ns="results">الأرباح</th>
                                    <th data-i18n="tables.headers.reinvest" data-i18n-ns="results">إعادة الاستثمار</th>
                                    <th data-i18n="tables.headers.cashOut" data-i18n-ns="results">السحب النقدي</th>
                                    <th data-i18n="tables.headers.expenses" data-i18n-ns="results">المصاريف</th>
                                    <th data-i18n="tables.headers.balance" data-i18n-ns="results">الرصيد</th>
                                    <th data-i18n="tables.headers.roi" data-i18n-ns="results">نسبة العائد</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- جدول البيانات اليومية -->
            <div class="card table-card">
                <div class="card-header">
                    <h2>
                        <i class="fas fa-calendar-day"></i>
                        <span data-i18n="tables.dailyDetails" data-i18n-ns="results">التفاصيل اليومية (أول 90 يوم)</span>
                    </h2>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="data-table" id="dailyDataTable">
                            <thead>
                                <tr>
                                    <th data-i18n="tables.headers.day" data-i18n-ns="results">اليوم</th>
                                    <th data-i18n="tables.headers.dailyProfit" data-i18n-ns="results">الربح اليومي</th>
                                    <th data-i18n="tables.headers.cashOut" data-i18n-ns="results">السحب النقدي</th>
                                    <th data-i18n="tables.headers.balance" data-i18n-ns="results">الرصيد</th>
                                </tr>
                            </thead>
                            <tbody id="dailyTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- دليل الاستخدام -->
        <div id="guide" class="section">
            <div class="card">
                <div class="card-header">
                    <h2>
                        <i class="fas fa-book-open"></i>
                        <span data-i18n="title" data-i18n-ns="guide">دليل الاستخدام</span>
                    </h2>
                </div>
                <div class="card-body guide-content">
                    <div class="guide-item">
                        <div class="guide-number">1</div>
                        <div class="guide-text">
                            <h3 data-i18n="steps.1.title" data-i18n-ns="guide">أدخل رأس المال الأساسي</h3>
                            <p data-i18n="steps.1.description" data-i18n-ns="guide">المبلغ الذي ستبدأ به التداول</p>
                        </div>
                    </div>

                    <div class="guide-item">
                        <div class="guide-number">2</div>
                        <div class="guide-text">
                            <h3 data-i18n="steps.2.title" data-i18n-ns="guide">حدد الربح المتوقع لكل صفقة</h3>
                            <p data-i18n="steps.2.description" data-i18n-ns="guide">متوسط الربح الذي تتوقعه من كل صفقة تداول</p>
                        </div>
                    </div>

                    <div class="guide-item">
                        <div class="guide-number">3</div>
                        <div class="guide-text">
                            <h3 data-i18n="steps.3.title" data-i18n-ns="guide">اختر عدد الصفقات اليومية</h3>
                            <p data-i18n="steps.3.description" data-i18n-ns="guide">كم صفقة تنوي تنفيذها يومياً</p>
                        </div>
                    </div>

                    <div class="guide-item">
                        <div class="guide-number">4</div>
                        <div class="guide-text">
                            <h3 data-i18n="steps.4.title" data-i18n-ns="guide">اضبط نسبة إعادة الاستثمار</h3>
                            <p data-i18n="steps.4.description" data-i18n-ns="guide">النسبة من الأرباح التي ستعيد استثمارها لزيادة رأس المال</p>
                        </div>
                    </div>

                    <div class="guide-item">
                        <div class="guide-number">5</div>
                        <div class="guide-text">
                            <h3 data-i18n="steps.5.title" data-i18n-ns="guide">احسب المصاريف الشهرية</h3>
                            <p data-i18n="steps.5.description" data-i18n-ns="guide">أي مصاريف ثابتة ستخصم من أرباحك شهرياً</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 <span data-i18n="app.title" data-i18n-ns="common">حاسبة التداول الذكية</span>. <span data-i18n="footer.copyright" data-i18n-ns="common">جميع الحقوق محفوظة</span>.</p>
            <p class="footer-note">
                <i class="fas fa-exclamation-triangle"></i>
                <span data-i18n="footer.disclaimer" data-i18n-ns="common">تنبيه: هذه الحسابات تقديرية ولا تضمن تحقيق أرباح فعلية. التداول ينطوي على مخاطر.</span>
            </p>
        </div>
    </footer>

    <script src="/js/main.js"></script>
    <script>
        // تحديث الرسوم البيانية عند تحميل الصفحة إذا كانت هناك نتائج
        document.addEventListener('DOMContentLoaded', function() {
            // يتم استدعاء createCharts من main.js عند الحصول على النتائج
        });
    </script>
</body>
</html>

